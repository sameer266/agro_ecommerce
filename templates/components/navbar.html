<!-- Minimalist Navbar Component -->
<nav class="navbar fixed top-0 left-0 right-0 z-50 flex justify-between items-center px-4 md:px-6 h-16">
 
<!-- Left Section -->
<div class="flex items-center gap-3">
    <!-- Sidebar toggle button -->
    <button class="menu-toggle" id="toggle-sidebar">
        <i class="fas fa-bars text-lg"></i>
    </button>

    <!-- Logo + Text -->
    <div class="flex items-center gap-2.5 text-base font-semibold text-gray-900">
        {% if organization.logo %}
            <img src="{{ organization.logo.url }}" alt="Logo" class="w-10 h-10 rounded-full object-cover shadow-sm">
        {% else %}
            <i class="fas fa-seedling text-2xl text-primary"></i>
        {% endif %}
        <span class="hidden sm:inline text-lg">{{ organization.name|capfirst }}</span>
    </div>
</div>

  
  <!-- Right Section -->
  <div class="flex items-center gap-2">

    <!-- Notifications Dropdown -->
    <div class="relative notification-dropdown">
      <button class="navbar-link">
        <i class="fas fa-bell text-base"></i>
        <span class="notification-badge">{{notifications_list.count}}</span>
      </button>

      <!-- Notifications Menu -->
   <div class="dropdown-content absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-lg border border-gray-200 z-50">
    <div class="p-4 border-b border-gray-100">
        <h3 class="font-semibold text-sm text-gray-900">Notifications</h3>
    </div>
    <div class="max-h-96 overflow-y-auto">
        {% if notifications %}
            {% for notification in notifications_list %}
                <a href="" class="notification-item {% if not notification.is_read %}bg-gray-50{% endif %} px-4 py-2 hover:bg-gray-100">
                    <div class="flex gap-3">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full {% if notification.notification_type == 'order' %}bg-blue-100{% elif notification.notification_type == 'product' %}bg-green-100{% elif notification.notification_type == 'payout' %}bg-orange-100{% elif notification.notification_type == 'selection' %}bg-purple-100{% elif notification.notification_type == 'delivery' %}bg-yellow-100{% else %}bg-gray-100{% endif %} flex items-center justify-center">
                            <!-- Optional icon based on type -->
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-sm font-medium text-gray-900">{{ notification.title }}</p>
                            <p class="text-xs text-gray-600 mt-0.5">{{ notification.message }}</p>
                            <p class="text-xs text-gray-500 mt-1">{{ notification.created_at|timesince }} ago</p>
                        </div>
                    </div>
                </a>
            {% endfor %}
        {% else %}
            <p class="text-xs text-gray-500 text-center py-3">No new notifications</p>
        {% endif %}
    </div>
    <div class="p-3 border-t border-gray-100 text-center">
        <a href="{% url 'admin_notification_list_page' %}" class="text-sm font-medium text-primary hover:text-primary-dark transition-colors">
            View All Notifications
        </a>
    </div>
</div>

    </div>

    <!-- User Profile Dropdown -->
  <!-- USER DROPDOWN -->
<div class="relative user-dropdown">
  <button class="flex items-center gap-2 px-2 py-1.5 rounded-lg hover:bg-gray-100">
    
    <!-- Avatar -->
    <div class="w-9 h-9 rounded-full border bg-gray-100 overflow-hidden flex items-center justify-center">
      {% if user.profile.avatar %}
        <img src="{{ user.profile.avatar.url }}" class="w-full h-full object-cover">
      {% else %}
        {% if request.user.role.role == 'admin' %}
          <i class="fas fa-user-shield text-blue-600"></i>
        {% elif request.user.role.role == 'vendor' %}
          <i class="fas fa-store text-teal-600"></i>
        {% elif request.user.role.role == 'farmer' %}
          <i class="fas fa-seedling text-green-600"></i>
        {% else %}
          <i class="fas fa-user text-gray-600"></i>
        {% endif %}
      {% endif %}
    </div>

    <!-- Name -->
    <div class="hidden md:block text-left">
      <p class="text-sm font-semibold">{{ request.user.role.role|capfirst }}</p>
      <p class="text-xs text-gray-500">{{ user.email }}</p>
    </div>

    <i class="fas fa-chevron-down text-xs text-gray-400 hidden md:block"></i>
  </button>

  <!-- Dropdown -->
  <div class="dropdown-content absolute right-0 mt-2 w-60 bg-white rounded-xl shadow-lg border">

    <div class="p-4 border-b">
      <p class="font-semibold">{{ request.user.role.role|capfirst }}</p>
      <p class="text-xs text-gray-500">{{ user.email }}</p>
    </div>

    <div class="p-2">

      <!-- ROLE-BASED LINKS INLINE -->
      {% if request.user.role.role == 'admin' %}
        <a href="{% url 'admin_organization_page' %}" class="flex items-center gap-3 px-3 py-2 text-sm hover:bg-gray-100 rounded-lg">
          <i class="fas fa-user w-4"></i> My Profile
        </a>
        <a href="{% url 'admin_change_password_page' %}" class="flex items-center gap-3 px-3 py-2 text-sm hover:bg-gray-100 rounded-lg">
          <i class="fas fa-lock w-4"></i> Change Password
        </a>
      {% elif request.user.role.role == 'vendor' %}
        <a href="{% url 'vendor_profile' %}" class="flex items-center gap-3 px-3 py-2 text-sm hover:bg-gray-100 rounded-lg">
          <i class="fas fa-user w-4"></i> My Profile
        </a>
    
      {% elif request.user.role.role == 'farmer' %}
        <a href="" class="flex items-center gap-3 px-3 py-2 text-sm hover:bg-gray-100 rounded-lg">
          <i class="fas fa-user w-4"></i> My Profile
        </a>
      
      {% endif %}

      <div class="border-t my-2"></div>
      <a href="{% url 'logout' %}" class="flex items-center gap-3 px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg">
        <i class="fas fa-sign-out-alt w-4"></i> Logout
      </a>
    </div>
  </div>
</div>


  </div>
</nav>

<style>
/* Navbar Link Styles */
.navbar-link {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 2.5rem;
  height: 2.5rem;
  border-radius: 0.5rem;
  transition: all 0.15s ease;
  color: #5f6368;
}

.navbar-link:hover {
  background: #f1f3f4;
  color: #202124;
}

/* Notification Badge */
.notification-badge {
  position: absolute;
  top: 0.125rem;
  right: 0.125rem;
  min-width: 1.125rem;
  height: 1.125rem;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #ea4335;
  color: white;
  font-size: 0.625rem;
  font-weight: 700;
  border-radius: 0.5rem;
  padding: 0 0.25rem;
  border: 2px solid white;
}

/* Dropdown Animation */
.dropdown-content {
  display: none;
  animation: slideDown 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Show dropdown on hover */
.notification-dropdown:hover .dropdown-content,
.user-dropdown:hover .dropdown-content {
  display: block;
}

/* Notification Item */
.notification-item {
  display: block;
  padding: 0.875rem 1rem;
  border-bottom: 1px solid #f1f3f4;
  transition: all 0.15s ease;
  text-decoration: none;
}

.notification-item:hover {
  background: #f8f9fa;
}

.notification-item:last-child {
  border-bottom: none;
}

/* User Avatar */
.user-avatar {
  width: 2rem;
  height: 2rem;
  border-radius: 50%;
  border: 2px solid #e8eaed;
  transition: all 0.15s ease;
}

.user-dropdown:hover .user-avatar {
  border-color: #2d6a4f;
}

/* Mobile Responsive */
@media (max-width: 640px) {
  .notification-dropdown .dropdown-content,
  .user-dropdown .dropdown-content {
    position: fixed;
    right: 0.5rem;
    left: 0.5rem;
    width: auto;
    max-width: calc(100vw - 1rem);
  }
}
</style>

<script>
$(document).ready(function() {
  // Close dropdowns when clicking outside
  $(document).on('click', function(e) {
    if (!$(e.target).closest('.notification-dropdown, .user-dropdown').length) {
      $('.dropdown-content').hide();
    }
  });

  // Toggle dropdowns on mobile
  $('.notification-dropdown > button, .user-dropdown > button').on('click', function(e) {
    if ($(window).width() <= 768) {
      e.preventDefault();
      e.stopPropagation();
      const dropdown = $(this).siblings('.dropdown-content');
      $('.dropdown-content').not(dropdown).hide();
      dropdown.toggle();
    }
  });

  // Prevent dropdown from closing when clicking inside
  $('.dropdown-content').on('click', function(e) {
    e.stopPropagation();
  });
});
</script>